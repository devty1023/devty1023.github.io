<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>devty</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
        <link href="http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css">
        <!-- favicon settings -->
        <link rel="icon" type="image/png" href="../images/favicons/favicon-196x196.png" sizes="196x196">
        <link rel="icon" type="image/png" href="../images/favicons/favicon-160x160.png" sizes="160x160">
        <link rel="icon" type="image/png" href="../images/favicons/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="../images/favicons/favicon-16x16.png" sizes="16x16">
        <link rel="icon" type="image/png" href="../images/favicons/favicon-32x32.png" sizes="32x32">


    </head>
    <body>
      <div id="main">
        <div id="sidebar">
          <h1>devty:</h1>
          <a href="../">home</a>
          <a href="../about.html">about</a>
          <a href="../archive.html">archive</a>
        </div>

        <div id="content">
            <h1>delayed argument passing</h1>

            <div class="info">
    Posted on September 23, 2014
    
        by devty
    
</div>

<p>Let’s say we want a program to do the following tasks:</p>
<ol style="list-style-type: decimal">
<li>Do something by calling <code>foo</code></li>
<li>Wait for additional data <code>data</code></li>
<li>Do something by calling <code>bar(data)</code></li>
</ol>
<p>This is not very hard in python, espeically if (2) involves getting a user input:</p>
<pre class="sourceCode python"><code class="sourceCode python">foo()
data = <span class="dt">input</span>()
bar(data)</code></pre>
<p>But say our <code>data</code> does not come from the user but maintains the quality of delayed injection into the process. What can we do?</p>
<h2 id="a-thread">a thread</h2>
<p>We can simply let the program spin until the data is prepared and signal is sent to the spinning process.</p>
<pre class="sourceCode python"><code class="sourceCode python">foo()
<span class="kw">try</span>:
    <span class="kw">while</span> <span class="ot">True</span>:
        time.sleep(X)
<span class="kw">except</span> Signal:
    <span class="kw">continue</span>
bar(data)</code></pre>
<p>But, as I mentioned in my previous post, I am wary of threading.</p>
<h2 id="an-object">an object</h2>
<p>We can encapsulate the operation into an object and run the two methods in the context of the object in two different occasion.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Foo(<span class="dt">object</span>):
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>):
        <span class="kw">pass</span>

    <span class="kw">def</span> foo():
        <span class="kw">pass</span>

    <span class="kw">def</span> bar(data):
        <span class="kw">pass</span>

x = Foo()
x.foo()
<span class="co">## get data</span>
x.bar(data)</code></pre>
<p>This is an okay solution. But can we do without objects?</p>
<h2 id="a-coroutine">a coroutine</h2>
<p>Python has a great support for <a href="http://en.wikipedia.org/wiki/Coroutine">coroutines</a> - functions that can be suspeneded and resumed with multiple entry points. Compare to threads which can be complicated to write and debug, python’s support for corutine is complete enough to provide a solution for our use case.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> foo():
    <span class="kw">return</span> <span class="st">&quot;foo&quot;</span>

<span class="kw">def</span> bar(data):
    <span class="kw">return</span> data

<span class="kw">def</span> foobar():
    <span class="kw">yield</span> foo()
    data = (<span class="kw">yield</span> <span class="st">&quot;hey&quot;</span>)
    <span class="kw">yield</span> bar(data)


x = foobar()
<span class="dt">print</span>(<span class="dt">next</span>(x))
<span class="dt">print</span>(<span class="dt">next</span>(x))
<span class="co">## get data</span>
<span class="dt">print</span>(x.send(data))

&gt;&gt; foo
&gt;&gt; hey
&gt;&gt; bar</code></pre>
<p><em>end of message</em></p>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
      </div>
    </body>
</html>
